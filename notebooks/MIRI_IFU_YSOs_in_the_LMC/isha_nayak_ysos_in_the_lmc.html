
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JWST Data Analysis &#8212; STScI JDAT Notebooks</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="MIRI LRS Optimal Spectral Extraction" href="../MIRI_LRS_spectral_extraction/miri_lrs_spectral_extraction.html" />
    <link rel="prev" title="MIRI MRS Spectroscopy of a Late M Star 2 - Data Analysis and Visualization" href="../MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_analysis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-D46G4HKJY3"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-D46G4HKJY3');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/stsci_logo2.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">STScI JDAT Notebooks</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   James Webb Space Telescope Data Analysis Tool Notebooks
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Cross-Instrument
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../asdf_example/asdf_example.html">
   Example of Converting a FITS File to ASDF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../background_estimation_imaging/Imaging%20Sky%20Background%20Estimation.html">
   Complex 2D Background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../composite_model_fitting/specfit_demo_3.html">
   Draft: Advanced Composite spectral model fitting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NIRSpec_MAST_Query/NIRSpec_MAST_Query.html">
   MAST Query
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../specviz_notebookGUI_interaction/specviz_notebook_gui_interaction_redshift.html">
   Specviz Simple Demo
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MIRI
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_runpipeline.html">
   MIRI MRS Spectroscopy of a Late M Star 1 - Running the Pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_analysis.html">
   Data Analysis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   JWST Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../MIRI_LRS_spectral_extraction/miri_lrs_spectral_extraction.html">
   LRS Extraction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  NIRCam
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../aperture_photometry/NIRCam_Aperture_Photometry_Example.html">
   Point Source Aperture Photometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NIRCam_photometry/NIRCam%20multiband%20photometry.html">
   NIRCam Multiband Photometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../psf_photometry/NIRCam_PSF_Photometry_Example.html">
   PSF Photometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NIRCam_PSF-matched_photometry/NIRCam_PSF_matched_multiband_photometry.html">
   NIRCam PSF-matched multiband photometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../preimaging/preimaging_02_calwebb.html">
   Preimaging - Calwebb
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../preimaging/preimaging_03_association.html">
   Creating simulated images of the JWST astrometric calibration field in the LMC
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  NIRISS
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../NIRISS_WFSS_postpipeline/00.%20Optimal%20extraction.html">
   Part 0: Optimal Extraction of NIRISS WFSS Spectrum
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NIRISS_WFSS_postpipeline/01.%20Combine%20and%20normalize%201D%20spectra.html">
   Part 1: Combine One-Dimensional NIRISS WFSS Spectra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NIRISS_WFSS_postpipeline/02.%20Cross%20correlation%20template.html">
   Part 2: Cross Correlation to Determine Redshift of NIRISS WFSS Spectra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../NIRISS_WFSS_postpipeline/03.%20Spatially%20resolved%20emission%20line%20map.html">
   Part 3: Spatially Resolved Emission Line Map of NIRISS WFSS Spectra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../niriss_ami_binary/1_niriss_ami_binary.html">
   NIRISS AMI simulation of binary point source AB Dor and calibrator HD37093
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../niriss_ami_binary/2_niriss_ami_binary.html">
   AMI Binary Star Notebook 2
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../soss-transit-spectroscopy/HAT-P-1b-PART3-data-analysis.html">
   SOSS Transient Spectroscopy
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  NIRSpec
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ifu_optimal/ifu_optimal.html">
   IFU Optimal Extraction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../optimal_extraction_dynamic/Spectral%20Extraction.html">
   NIRSpec MOS Optimal Spectral Extraction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mos-spectroscopy/MOSspec_sv06_revised.html">
   MOS Spectroscopy of Extragalactic Field
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../transit_spectroscopy_notebook/Exoplanet_Transmission_Spectra_JWST.html">
   Extracting an Exoplanet Transmission Spectrum from NIRSpec BOTS Time Series Observations
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/MIRI_IFU_YSOs_in_the_LMC/isha_nayak_ysos_in_the_lmc.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/spacetelescope/jdat_notebooks/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/spacetelescope/jdat_notebooks//issues/new?title=Issue%20on%20page%20%2Fnotebooks/MIRI_IFU_YSOs_in_the_LMC/isha_nayak_ysos_in_the_lmc.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   JWST Data Analysis
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#young-stellar-objects-in-the-large-magellanic-cloud">
   Young Stellar Objects in the Large Magellanic Cloud
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-things-you-need">
     Import things you need
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-versions-of-imported-things">
     Check versions of imported things
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setup-output-directory-for-figures-and-spectra">
     Setup output directory for figures and spectra
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-plot-paramters">
     Set plot paramters
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-path-to-data">
     Set path to data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-and-display-data-cube">
     Load and display data cube
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trim-the-cube">
     Trim the cube
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#make-a-2d-image-from-the-3d-cube-either-with-average-median-or-sum">
     Make a 2D image from the 3D cube either with average, median, or sum
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-image-to-do-a-visual-check">
     Plot the image to do a visual check
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-summed-image-with-wcs-coordinates-and-save-the-figure">
     Plot the summed image with WCS coordinates and save the figure
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#identify-all-point-sources-using-photutils">
     Identify all point sources using photutils
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-a-list-of-all-point-sources">
     Get a list of all point sources
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extract-and-plot-spectrum-of-all-sources">
     Extract and plot spectrum of all sources
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#make-a-table-for-the-extracted-sources">
     Make a Table for the Extracted Sources
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-spitzer-irs-yso-spectra-from-here-on-out-for-science-test-cases">
     Use Spitzer IRS YSO Spectra from Here on Out For Science Test Cases
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fit-a-generic-continuum">
     Fit a generic continuum
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-for-emission-and-absorption-lines">
     Look For Emission and Absorption Lines
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#identify-emission-and-absorption-lines">
     Identify emission and absorption lines
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classify-the-yso-according-to-what-lines-are-detected">
     Classify the YSO according to what lines are detected
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-spectra-and-label-the-emission-and-absorption-features">
     Plot the spectra and label the emission and absorption features
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>JWST Data Analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   JWST Data Analysis
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#young-stellar-objects-in-the-large-magellanic-cloud">
   Young Stellar Objects in the Large Magellanic Cloud
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-things-you-need">
     Import things you need
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-versions-of-imported-things">
     Check versions of imported things
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#setup-output-directory-for-figures-and-spectra">
     Setup output directory for figures and spectra
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-plot-paramters">
     Set plot paramters
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-path-to-data">
     Set path to data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-and-display-data-cube">
     Load and display data cube
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trim-the-cube">
     Trim the cube
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#make-a-2d-image-from-the-3d-cube-either-with-average-median-or-sum">
     Make a 2D image from the 3D cube either with average, median, or sum
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-image-to-do-a-visual-check">
     Plot the image to do a visual check
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-summed-image-with-wcs-coordinates-and-save-the-figure">
     Plot the summed image with WCS coordinates and save the figure
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#identify-all-point-sources-using-photutils">
     Identify all point sources using photutils
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-a-list-of-all-point-sources">
     Get a list of all point sources
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extract-and-plot-spectrum-of-all-sources">
     Extract and plot spectrum of all sources
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#make-a-table-for-the-extracted-sources">
     Make a Table for the Extracted Sources
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-spitzer-irs-yso-spectra-from-here-on-out-for-science-test-cases">
     Use Spitzer IRS YSO Spectra from Here on Out For Science Test Cases
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fit-a-generic-continuum">
     Fit a generic continuum
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-for-emission-and-absorption-lines">
     Look For Emission and Absorption Lines
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#identify-emission-and-absorption-lines">
     Identify emission and absorption lines
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#classify-the-yso-according-to-what-lines-are-detected">
     Classify the YSO according to what lines are detected
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-spectra-and-label-the-emission-and-absorption-features">
     Plot the spectra and label the emission and absorption features
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="jwst-data-analysis">
<h1>JWST Data Analysis<a class="headerlink" href="#jwst-data-analysis" title="Permalink to this headline">¶</a></h1>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="young-stellar-objects-in-the-large-magellanic-cloud">
<h1>Young Stellar Objects in the Large Magellanic Cloud<a class="headerlink" href="#young-stellar-objects-in-the-large-magellanic-cloud" title="Permalink to this headline">¶</a></h1>
<p>The LMC is the ideal site to study massive star formation because it is relatively close (d ~ 50 kpc) and has a face-on orientation so that we can resolve individual star formation sites and eliminate line of sight confusion. The Spitzer and Herschel surveys have identified thousands of YSOs in the LMC by using photometry that spans from 3 microns to 500 microns and are complete down to 8 solar mass YSOs.</p>
<p>We know massive star formation occurs in dense molecular gas. ALMA observations of 12CO and 13CO molecular gas show evidence that colliding filaments can be a mechanisms for gas densities to be as high as 10^6 cm^-3. Massive stars up go 50 solar masses have been observed in dense cores at the center of colliding CO gas filaments seen with ALMA.</p>
<p>The instruments on JWST will have angular resolutions 10 times better than Spitzer Space Telescope and sensitivities over a hundred times better than current instruments. Observations of YSOs with MIRI and NIRCam will be complete down to 1 solar mass YSOs, as oppose to 8 solar mass YSOs with Spitzer observations. The massive YSOs in the LMC are most likely a small cluster of YSOs, and with MRS we can get spectra of the individual object in the cluster. This will be a powerful tool in understanding star formation and cluster formation.</p>
<p>For the first part, I use ALMA 13CO data cubes to read in the cube and make figures. There are nearly 400 massive stars in the footprint shown in this notebook. One of the goals of this notebook is to use photutils to automatically detect point sources and extract photometry in a given 3D cube. For the second part, I use Spitzer/IRS spectra of a known early-stage YSOs. YSOs have specific absorption and emission lines. The goal is to first use specutils to find the important lines to first identify if something is or is not a YSO based on what lines do exist or do not exist. And then the next step is to identify if the YSO is Stage I (most embedded with CO2 ice feature), Stage II (more evolved with ice and silicate absorption features), or Stage III (almost a flat spectrum with PAH emission) based on the emission and absorption lines detected.</p>
<div class="section" id="import-things-you-need">
<h2>Import things you need<a class="headerlink" href="#import-things-you-need" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astropy.wcs</span> <span class="kn">import</span> <span class="n">WCS</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">constants</span> <span class="k">as</span> <span class="n">const</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">ascii</span><span class="p">,</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.nddata</span> <span class="kn">import</span> <span class="n">StdDevUncertainty</span>
<span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">vstack</span>
<span class="kn">from</span> <span class="nn">astropy.stats</span> <span class="kn">import</span> <span class="n">sigma_clipped_stats</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="kn">from</span> <span class="nn">spectral_cube</span> <span class="kn">import</span> <span class="n">SpectralCube</span>
<span class="kn">from</span> <span class="nn">photutils</span> <span class="kn">import</span> <span class="n">DAOStarFinder</span><span class="p">,</span> <span class="n">CircularAperture</span>

<span class="kn">from</span> <span class="nn">specutils</span> <span class="kn">import</span> <span class="n">Spectrum1D</span><span class="p">,</span> <span class="n">SpectralRegion</span>
<span class="kn">from</span> <span class="nn">specutils.analysis</span> <span class="kn">import</span> <span class="n">snr</span><span class="p">,</span> <span class="n">line_flux</span><span class="p">,</span> <span class="n">centroid</span><span class="p">,</span> <span class="n">equivalent_width</span>
<span class="kn">from</span> <span class="nn">specutils.fitting</span> <span class="kn">import</span> <span class="n">fit_generic_continuum</span><span class="p">,</span> <span class="n">fit_continuum</span><span class="p">,</span> <span class="n">find_lines_threshold</span><span class="p">,</span>  <span class="n">find_lines_derivative</span><span class="p">,</span> <span class="n">estimate_line_parameters</span><span class="p">,</span> <span class="n">fit_lines</span>
<span class="kn">from</span> <span class="nn">specutils.manipulation</span> <span class="kn">import</span> <span class="n">noise_region_uncertainty</span><span class="p">,</span> <span class="n">box_smooth</span><span class="p">,</span> <span class="n">extract_region</span><span class="p">,</span> <span class="n">gaussian_smooth</span><span class="p">,</span> <span class="n">SplineInterpolatedResampler</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="check-versions-of-imported-things">
<h2>Check versions of imported things<a class="headerlink" href="#check-versions-of-imported-things" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">aplpy</span>
<span class="kn">from</span> <span class="nn">aplpy</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">aplpy_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Aplpy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">aplpy_version</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">astrodendro</span>
<span class="kn">from</span> <span class="nn">astrodendro</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">astrodendro_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Astrodendro: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">astrodendro_version</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">astropy</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">astropy_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Astropy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">astropy_version</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">jwst</span>
<span class="kn">from</span> <span class="nn">jwst</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">jwst_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;JWST: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">jwst_version</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">matplotlib_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matplotlib: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">matplotlib_version</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">numpy_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numpy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">numpy_version</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">pandas_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pandas: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pandas_version</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">photutils</span>
<span class="kn">from</span> <span class="nn">photutils</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">photutils_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Photutils: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">photutils_version</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">scipy_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Scipy: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scipy_version</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">specutils</span>
<span class="kn">from</span> <span class="nn">specutils</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">specutils_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Specutils: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">specutils_version</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">spectral_cube</span>
<span class="kn">from</span> <span class="nn">spectral_cube</span> <span class="kn">import</span> <span class="n">__version__</span> <span class="k">as</span> <span class="n">spectral_cube_version</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SpectralCube: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spectral_cube_version</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Aplpy: 2.1.0
Astrodendro: 0.2.0
Astropy: 5.0.4
JWST: 1.4.6
Matplotlib: 3.5.1
Numpy: 1.22.3
Pandas: 1.4.2
Photutils: 1.4.0
Scipy: 1.8.0
Specutils: 1.7.0
SpectralCube: 0.6.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="setup-output-directory-for-figures-and-spectra">
<h2>Setup output directory for figures and spectra<a class="headerlink" href="#setup-output-directory-for-figures-and-spectra" title="Permalink to this headline">¶</a></h2>
<p>The user needs to setup their own path to where they want the output to be located.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_images</span> <span class="o">=</span> <span class="s1">&#39;./Images&#39;</span> <span class="c1"># This is where the output images will be located</span>
<span class="n">output_spectra</span> <span class="o">=</span> <span class="s1">&#39;./Spectra&#39;</span> <span class="c1"># This is where the output spectra will be located</span>

<span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="p">[</span><span class="n">output_images</span><span class="p">,</span> <span class="n">output_spectra</span><span class="p">]:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-plot-paramters">
<h2>Set plot paramters<a class="headerlink" href="#set-plot-paramters" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="s1">&#39;18&#39;</span><span class="p">,</span>
        <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="s1">&#39;18&#39;</span><span class="p">,</span>
        <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="s1">&#39;18&#39;</span><span class="p">,</span>
        <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span> <span class="s1">&#39;18&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="s1">&#39;18&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lines.linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;axes.linewidth&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;animation.html&#39;</span><span class="p">:</span> <span class="s1">&#39;html5&#39;</span><span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.max_open_warning&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="set-path-to-data">
<h2>Set path to data<a class="headerlink" href="#set-path-to-data" title="Permalink to this headline">¶</a></h2>
<p>I am using ALMA 13CO from a known star formation region in the LMC host to nearly 150 massive YSOs.</p>
<p>Note that the data file can be pulled from Box and installed locally in the user’s disk. This will save time when running the notebook multiple times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_cube_file</span> <span class="o">=</span> <span class="s1">&#39;https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/MIRI_IFU_YSOs_in_the_LMC/LMC_13CO.fits&#39;</span>
<span class="c1"># data_cube_file = &#39;LMC_13CO.fits&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-and-display-data-cube">
<h2>Load and display data cube<a class="headerlink" href="#load-and-display-data-cube" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cube</span> <span class="o">=</span> <span class="n">SpectralCube</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">data_cube_file</span><span class="p">,</span> <span class="n">hdu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  
<span class="nb">print</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">Input In [7],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">cube</span> <span class="o">=</span> <span class="n">SpectralCube</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">data_cube_file</span><span class="p">,</span> <span class="n">hdu</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="nb">print</span><span class="p">(</span><span class="n">cube</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/site-packages/spectral_cube/io/core.py:118,</span> in <span class="ni">SpectralCubeRead.__call__</span><span class="nt">(self, filename, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">116</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;target_cls&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">BaseSpectralCube</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">118</span>     <span class="k">return</span> <span class="n">registry</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">BaseSpectralCube</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">119</span> <span class="k">except</span> <span class="ne">IsADirectoryError</span><span class="p">:</span>  <span class="c1"># See note above StringWrapper</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span>     <span class="k">return</span> <span class="n">registry</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">BaseSpectralCube</span><span class="p">,</span> <span class="n">StringWrapper</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/site-packages/astropy/io/registry/compat.py:43,</span> in <span class="ni">_make_io_func.&lt;locals&gt;.wrapper</span><span class="nt">(registry, *args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">41</span>     <span class="n">registry</span> <span class="o">=</span> <span class="n">default_registry</span>
<span class="g g-Whitespace">     </span><span class="mi">42</span> <span class="c1"># get and call bound method from registry instance</span>
<span class="ne">---&gt; </span><span class="mi">43</span> <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">registry</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/site-packages/astropy/io/registry/core.py:184,</span> in <span class="ni">UnifiedInputRegistry.read</span><span class="nt">(self, cls, format, cache, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">182</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">183</span>     <span class="n">ctx</span> <span class="o">=</span> <span class="n">get_readable_fileobj</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">184</span>     <span class="n">fileobj</span> <span class="o">=</span> <span class="n">ctx</span><span class="o">.</span><span class="fm">__enter__</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">185</span> <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span>     <span class="k">raise</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/contextlib.py:119,</span> in <span class="ni">_GeneratorContextManager.__enter__</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">117</span> <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwds</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
<span class="g g-Whitespace">    </span><span class="mi">118</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">119</span>     <span class="k">return</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gen</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">120</span> <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">121</span>     <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;generator didn&#39;t yield&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/site-packages/astropy/utils/data.py:268,</span> in <span class="ni">get_readable_fileobj</span><span class="nt">(name_or_obj, encoding, cache, show_progress, remote_timeout, sources, http_headers)</span>
<span class="g g-Whitespace">    </span><span class="mi">266</span> <span class="n">is_url</span> <span class="o">=</span> <span class="n">_is_url</span><span class="p">(</span><span class="n">name_or_obj</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">267</span> <span class="k">if</span> <span class="n">is_url</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">268</span>     <span class="n">name_or_obj</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">269</span>         <span class="n">name_or_obj</span><span class="p">,</span> <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span> <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span>         <span class="n">timeout</span><span class="o">=</span><span class="n">remote_timeout</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="n">sources</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">271</span>         <span class="n">http_headers</span><span class="o">=</span><span class="n">http_headers</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">272</span> <span class="n">fileobj</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">FileIO</span><span class="p">(</span><span class="n">name_or_obj</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">273</span> <span class="k">if</span> <span class="n">is_url</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">cache</span><span class="p">:</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/site-packages/astropy/utils/data.py:1364,</span> in <span class="ni">download_file</span><span class="nt">(remote_url, cache, show_progress, timeout, sources, pkgname, http_headers, ssl_context, allow_insecure)</span>
<span class="g g-Whitespace">   </span><span class="mi">1362</span> <span class="k">for</span> <span class="n">source_url</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1363</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1364</span>         <span class="n">f_name</span> <span class="o">=</span> <span class="n">_download_file_from_source</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1365</span>                 <span class="n">source_url</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1366</span>                 <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1367</span>                 <span class="n">show_progress</span><span class="o">=</span><span class="n">show_progress</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1368</span>                 <span class="n">cache</span><span class="o">=</span><span class="n">cache</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1369</span>                 <span class="n">remote_url</span><span class="o">=</span><span class="n">remote_url</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1370</span>                 <span class="n">pkgname</span><span class="o">=</span><span class="n">pkgname</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1371</span>                 <span class="n">http_headers</span><span class="o">=</span><span class="n">http_headers</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1372</span>                 <span class="n">ssl_context</span><span class="o">=</span><span class="n">ssl_context</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1373</span>                 <span class="n">allow_insecure</span><span class="o">=</span><span class="n">allow_insecure</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1374</span>         <span class="c1"># Success!</span>
<span class="g g-Whitespace">   </span><span class="mi">1375</span>         <span class="k">break</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/site-packages/astropy/utils/data.py:1202,</span> in <span class="ni">_download_file_from_source</span><span class="nt">(source_url, show_progress, timeout, remote_url, cache, pkgname, http_headers, ftp_tls, ssl_context, allow_insecure)</span>
<span class="g g-Whitespace">   </span><span class="mi">1200</span> <span class="n">bytes_read</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1201</span> <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">bytes_read</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1202</span> <span class="n">block</span> <span class="o">=</span> <span class="n">remote</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">conf</span><span class="o">.</span><span class="n">download_block_size</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1203</span> <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">bytes_read</span> <span class="o">&gt;</span> <span class="n">size</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1204</span>     <span class="k">raise</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1205</span>         <span class="sa">f</span><span class="s2">&quot;File was supposed to be </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2"> bytes but &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1206</span>         <span class="sa">f</span><span class="s2">&quot;server provides more, at least </span><span class="si">{</span><span class="n">bytes_read</span><span class="si">}</span><span class="s2"> &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1207</span>         <span class="sa">f</span><span class="s2">&quot;bytes. Download failed.&quot;</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/http/client.py:462,</span> in <span class="ni">HTTPResponse.read</span><span class="nt">(self, amt)</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span> <span class="k">if</span> <span class="n">amt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">460</span>     <span class="c1"># Amount is given, implement using readinto</span>
<span class="g g-Whitespace">    </span><span class="mi">461</span>     <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">462</span>     <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readinto</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">463</span>     <span class="k">return</span> <span class="nb">memoryview</span><span class="p">(</span><span class="n">b</span><span class="p">)[:</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">tobytes</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">465</span>     <span class="c1"># Amount is not given (unbounded read) so we must check self.length</span>
<span class="g g-Whitespace">    </span><span class="mi">466</span>     <span class="c1"># and self.chunked</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/http/client.py:506,</span> in <span class="ni">HTTPResponse.readinto</span><span class="nt">(self, b)</span>
<span class="g g-Whitespace">    </span><span class="mi">501</span>         <span class="n">b</span> <span class="o">=</span> <span class="nb">memoryview</span><span class="p">(</span><span class="n">b</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">503</span> <span class="c1"># we do not use _safe_read() here because this may be a .will_close</span>
<span class="g g-Whitespace">    </span><span class="mi">504</span> <span class="c1"># connection, and the user is reading more bytes than will be provided</span>
<span class="g g-Whitespace">    </span><span class="mi">505</span> <span class="c1"># (for example, reading in 1k chunks)</span>
<span class="ne">--&gt; </span><span class="mi">506</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fp</span><span class="o">.</span><span class="n">readinto</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">507</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">b</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">508</span>     <span class="c1"># Ideally, we would raise IncompleteRead if the content-length</span>
<span class="g g-Whitespace">    </span><span class="mi">509</span>     <span class="c1"># wasn&#39;t satisfied, but it might break compatibility.</span>
<span class="g g-Whitespace">    </span><span class="mi">510</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_close_conn</span><span class="p">()</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/socket.py:704,</span> in <span class="ni">SocketIO.readinto</span><span class="nt">(self, b)</span>
<span class="g g-Whitespace">    </span><span class="mi">702</span> <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">703</span>     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">704</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sock</span><span class="o">.</span><span class="n">recv_into</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span>     <span class="k">except</span> <span class="n">timeout</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">706</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_timeout_occurred</span> <span class="o">=</span> <span class="kc">True</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/ssl.py:1241,</span> in <span class="ni">SSLSocket.recv_into</span><span class="nt">(self, buffer, nbytes, flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1237</span>     <span class="k">if</span> <span class="n">flags</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1238</span>         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1239</span>           <span class="s2">&quot;non-zero flags not allowed in calls to recv_into() on </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
<span class="g g-Whitespace">   </span><span class="mi">1240</span>           <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1241</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">nbytes</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1242</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1243</span>     <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">recv_into</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">nbytes</span><span class="p">,</span> <span class="n">flags</span><span class="p">)</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/ssl.py:1099,</span> in <span class="ni">SSLSocket.read</span><span class="nt">(self, len, buffer)</span>
<span class="g g-Whitespace">   </span><span class="mi">1097</span> <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1098</span>     <span class="k">if</span> <span class="n">buffer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1099</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1100</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1101</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="trim-the-cube">
<h2>Trim the cube<a class="headerlink" href="#trim-the-cube" title="Permalink to this headline">¶</a></h2>
<p>Not sure about JWST MRS cube, but in ALMA the beginning and end of cube have poor data quality so you can trim the cube to make it smaller if you want. I used the whole cube in this example.</p>
<p>If you want to trim the cube to a certain spectral range then do the following:</p>
<p>subcube = cube.spectral_slab(240 * (u.m/u.s), 265 * (u.m/u.s))</p>
<p>cube=subcube</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cube</span><span class="o">.</span><span class="n">allow_huge_operations</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cmin</span> <span class="o">=</span> <span class="n">cube</span><span class="o">.</span><span class="n">minimal_subcube</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-a-2d-image-from-the-3d-cube-either-with-average-median-or-sum">
<h2>Make a 2D image from the 3D cube either with average, median, or sum<a class="headerlink" href="#make-a-2d-image-from-the-3d-cube-either-with-average-median-or-sum" title="Permalink to this headline">¶</a></h2>
<p>This is to look for point sources. After you locate point sources, you will be applying aperture photometry to extract the spectrum.</p>
<p>The code can take awhile since it is a big data cube.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cont_img</span> <span class="o">=</span> <span class="n">cmin</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-the-image-to-do-a-visual-check">
<h2>Plot the image to do a visual check<a class="headerlink" href="#plot-the-image-to-do-a-visual-check" title="Permalink to this headline">¶</a></h2>
<p>This is to see if you even see any emission and to make sure you have the correct data cube.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cont_img</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-the-summed-image-with-wcs-coordinates-and-save-the-figure">
<h2>Plot the summed image with WCS coordinates and save the figure<a class="headerlink" href="#plot-the-summed-image-with-wcs-coordinates-and-save-the-figure" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;13CO&#39;</span>

<span class="n">F</span> <span class="o">=</span> <span class="n">aplpy</span><span class="o">.</span><span class="n">FITSFigure</span><span class="p">(</span><span class="n">cont_img</span><span class="o">.</span><span class="n">hdu</span><span class="p">,</span> <span class="n">north</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">F</span><span class="o">.</span><span class="n">show_colorscale</span><span class="p">()</span>
<span class="n">F</span><span class="o">.</span><span class="n">add_label</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">F</span><span class="o">.</span><span class="n">axis_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>
<span class="n">F</span><span class="o">.</span><span class="n">tick_labels</span><span class="o">.</span><span class="n">set_font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">stretch</span><span class="o">=</span><span class="s1">&#39;condensed&#39;</span><span class="p">)</span>
<span class="n">F</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output_images</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">name</span><span class="o">+</span><span class="s2">&quot;.pdf&quot;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="identify-all-point-sources-using-photutils">
<h2>Identify all point sources using photutils<a class="headerlink" href="#identify-all-point-sources-using-photutils" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Empty array to store values</span>
<span class="n">name_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">source_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ra_val</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dec_val</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Find mean, meadian, and standard deviation of the summed image</span>
<span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">cont_img</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="get-a-list-of-all-point-sources">
<h2>Get a list of all point sources<a class="headerlink" href="#get-a-list-of-all-point-sources" title="Permalink to this headline">¶</a></h2>
<p>Note that usually it is 3<em>std to find sources above noise level, but there are 247 point sources when I do that. So I made it 6</em>std to look at 4 point sources and make sure this step works.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">fwhm</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">6</span><span class="o">*</span><span class="n">std</span><span class="p">)</span>
<span class="n">sources</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">cont_img</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">median</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">  Number of sources in field: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extract-and-plot-spectrum-of-all-sources">
<h2>Extract and plot spectrum of all sources<a class="headerlink" href="#extract-and-plot-spectrum-of-all-sources" title="Permalink to this headline">¶</a></h2>
<p>This step can take while to run</p>
<p>Do a visual check to see if all point sources have been identified, although the end result should be that this is not necessary. Also as a science user, I would like the algorithm to tell me what is and isn’t a point source mathematically. There should be some criteria that differences point and extended sources that the user shouldn’t have to visually check. Of the four sources, two are noise spectra because it detected noise spikes on the border of the ALMA cube which is a common thing with ALMA data cubes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make table be consistent with RA and DEC coordinates</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sources</span><span class="o">.</span><span class="n">colnames</span><span class="p">:</span>    
        <span class="n">sources</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.8g</span><span class="s1">&#39;</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>  
    
    <span class="c1"># Convert xcentroid and ycentroid to RA and DEC coordiantes</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]])</span>                
    <span class="n">w</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">cont_img</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>                                                       
    <span class="n">radec_lst</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">pixel_to_world</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>

    <span class="c1"># Aperture extract spectrum of point source Using a cirular aperture            </span>
    <span class="k">for</span> <span class="n">countS</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sources</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">radec_lst</span><span class="p">[</span><span class="n">countS</span><span class="p">]</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s1">&#39;hmsdms&#39;</span><span class="p">))</span>  <span class="c1"># Print the RA and Dec in hms dms values   </span>
        
        <span class="n">name_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">source_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">countS</span><span class="p">)</span>
        <span class="n">ra_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">radec_lst</span><span class="p">[</span><span class="n">countS</span><span class="p">]</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
        <span class="n">dec_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">radec_lst</span><span class="p">[</span><span class="n">countS</span><span class="p">]</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
    
        <span class="c1"># Size of frame </span>
        <span class="n">ysize_pix</span> <span class="o">=</span> <span class="n">cmin</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">xsize_pix</span> <span class="o">=</span> <span class="n">cmin</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="c1"># Set up some centroid pixel for the source </span>
        <span class="n">ycent_pix</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">][</span><span class="n">countS</span><span class="p">]</span>
        <span class="n">xcent_pix</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">][</span><span class="n">countS</span><span class="p">]</span>

        <span class="c1"># Make an aperture radius for source</span>
        <span class="c1"># This can be something the user inputs based on their own science expertise.</span>
        <span class="n">apertureRad_pix</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="c1"># Make a masked array for the apeture</span>
        <span class="n">yy</span><span class="p">,</span> <span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">indices</span><span class="p">([</span><span class="n">ysize_pix</span><span class="p">,</span> <span class="n">xsize_pix</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>  <span class="c1"># Check ycentpix, xcentpix are in correct order </span>
        <span class="n">radius</span> <span class="o">=</span> <span class="p">((</span><span class="n">yy</span> <span class="o">-</span> <span class="n">ycent_pix</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="n">xcent_pix</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>  <span class="c1"># Make a circle in the frame</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">&lt;=</span> <span class="n">apertureRad_pix</span>  <span class="c1"># Select pixels within the aperture radius</span>
        <span class="n">maskedcube</span> <span class="o">=</span> <span class="n">cmin</span><span class="o">.</span><span class="n">with_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>  <span class="c1"># Make a masked cube</span>
        <span class="n">pixInAp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">mask</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Pixels in apeture</span>

        <span class="n">spectrum</span> <span class="o">=</span> <span class="n">maskedcube</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># Extract the spectrum from only the annulus</span>
        <span class="n">noisespectrum</span> <span class="o">=</span> <span class="n">maskedcube</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># Extract the noise spectrum for the source </span>

        <span class="c1"># Measure a spectrum from the background. Use an annulus arround the source.</span>
        <span class="n">an_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">radius</span> <span class="o">&gt;</span> <span class="n">apertureRad_pix</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">radius</span> <span class="o">&lt;=</span> <span class="n">apertureRad_pix</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Select pixels within an anulus</span>
        <span class="n">an_maskedcube</span> <span class="o">=</span> <span class="n">cmin</span><span class="o">.</span><span class="n">with_mask</span><span class="p">(</span><span class="n">an_mask</span><span class="p">)</span>  <span class="c1"># Make a masked cube</span>
    
        <span class="c1"># Plot the spectrum extracted from cirular aperture via: a sum extraction </span>
        
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">maskedcube</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">spectrum</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Source&#39;</span><span class="p">)</span>  <span class="c1"># Source spectrum </span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency [Hz]&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Kelvin&#39;</span><span class="p">)</span> 
        <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.80</span><span class="p">,</span> <span class="n">radec_lst</span><span class="p">[</span><span class="n">countS</span><span class="p">]</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s1">&#39;decimal&#39;</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
        <span class="n">positions_pix</span> <span class="o">=</span> <span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>
    
        <span class="n">apertures</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">([</span><span class="n">positions_pix</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">countS</span><span class="p">],</span> <span class="n">positions_pix</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">countS</span><span class="p">]],</span> <span class="n">r</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>            

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cont_img</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
        
        <span class="n">apertures</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cont_img</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-a-table-for-the-extracted-sources">
<h2>Make a Table for the Extracted Sources<a class="headerlink" href="#make-a-table-for-the-extracted-sources" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sourceExtSpecTab</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">name_val</span><span class="p">,</span> <span class="n">source_val</span><span class="p">,</span> <span class="n">ra_val</span><span class="p">,</span> <span class="n">dec_val</span><span class="p">],</span> 
                         <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;source_no&quot;</span><span class="p">,</span> <span class="s2">&quot;ra&quot;</span><span class="p">,</span> <span class="s2">&quot;dec&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sourceExtSpecTab</span><span class="p">)</span>   

<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_spectra</span><span class="p">,</span> <span class="s1">&#39;YSOsourcesSpec_list.csv&#39;</span><span class="p">)</span>
<span class="n">ascii</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sourceExtSpecTab</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_spectra</span><span class="p">,</span> <span class="s1">&#39;YSOsourcesSpec_list.csv&#39;</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="use-spitzer-irs-yso-spectra-from-here-on-out-for-science-test-cases">
<h2>Use Spitzer IRS YSO Spectra from Here on Out For Science Test Cases<a class="headerlink" href="#use-spitzer-irs-yso-spectra-from-here-on-out-for-science-test-cases" title="Permalink to this headline">¶</a></h2>
<p>(1) Look for lines in Spectra. Ice features in the 5-7 micron range from H20, NH3, CH3OH, HCOOH, and H2CO are difficult to identify because confusion with PAH. The 15.2 micron CO2 ice absorbtion is better to identify. More evolved YSOs will have PAH and fine-structure features at 6.2 micron, 7.7 micron, 8.6 micron, 11.3 micron, and 12.7 micron. But PAH and fine-sturcture could mean a more evolved HII region rather than an embedded YSO. H2 emission is expected from YSOs. Both PDRs and shocks lead to H2 emission near YSO environments.</p>
<p>(2) Look at ice features, PAH feature, and silicate features in more detail.</p>
<p>(3) Identify YSOs.</p>
<p>User can decide which YSO they want to check. YSO1, YSO2, or YSO3 and comment out the code accordingly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set Path to YSO1 Data</span>
<span class="n">YSO1</span> <span class="o">=</span> <span class="s1">&#39;https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/MIRI_IFU_YSOs_in_the_LMC/yso1_108_spec.txt&#39;</span>

<span class="c1"># Set Path to YSO2 Data</span>
<span class="c1"># YSO2 = &#39;https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/MIRI_IFU_YSOs_in_the_LMC/yso2_102_spec.txt&#39;</span>

<span class="c1"># Set Path to YSO3 Data</span>
<span class="c1"># YSO3 = &#39;https://data.science.stsci.edu/redirect/JWST/jwst-data_analysis_tools/MIRI_IFU_YSOs_in_the_LMC/yso3_4536_spec.txt&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Choose YSO1, YSO2, or YSO3 in this section too.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the spectra and plot it for initial visualization check</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">YSO1</span><span class="p">)</span>
<span class="c1"># data = ascii.read(YSO2)</span>
<span class="c1"># data = ascii.read(YSO3)</span>

<span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">colnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;col1&#39;</span><span class="p">:</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;wave_mum&#39;</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;col2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;cSpec_Jy&#39;</span>            
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;col3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;errFl_Jy&#39;</span>         

<span class="n">wav</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wave_mum&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>  <span class="c1"># Wavelength: microns</span>
<span class="n">fl</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;cSpec_Jy&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Jy</span>  <span class="c1"># Fnu: Jy</span>
<span class="n">efl</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;errFl_Jy&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Jy</span>  <span class="c1"># Error flux: Jy</span>

<span class="n">spec</span> <span class="o">=</span> <span class="n">Spectrum1D</span><span class="p">(</span><span class="n">spectral_axis</span><span class="o">=</span><span class="n">wav</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">fl</span><span class="p">,</span> <span class="n">uncertainty</span><span class="o">=</span><span class="n">StdDevUncertainty</span><span class="p">(</span><span class="n">efl</span><span class="p">))</span>  <span class="c1"># Make a 1D spectrum object</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>                
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (microns)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="fit-a-generic-continuum">
<h2>Fit a generic continuum<a class="headerlink" href="#fit-a-generic-continuum" title="Permalink to this headline">¶</a></h2>
<p>The continuum seems to be overestimated 5 micron - 7 micron and then again 17 micron - 25 micron when fitting a generic continuum without excluding any wavelengths. This leads to misidentification of emissiona and abroption lines. Rather I fit a continuum to 5-13 micron range and another continuum for the 13-35 micron range. This gives a much better continuum subtracted spectrum. But that means that I will have to keep track of two different line lists fo absorption and emission features. It would be better if I can fit one continuum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate S/N</span>
<span class="n">sig2noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">snr</span><span class="p">(</span><span class="n">spec</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Fit one continuum for wavelengths greater than 13 microns excluding a couple lines</span>
<span class="n">to_exclude_1</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">13.0</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">,</span> <span class="p">(</span><span class="mf">14.5</span><span class="p">,</span> <span class="mf">15.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">,</span> <span class="p">(</span><span class="mf">17.0</span><span class="p">,</span> <span class="mf">18.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">]</span>  <span class="c1"># Define lines/regions to exclude</span>
<span class="n">exclude_region_1</span> <span class="o">=</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="n">to_exclude_1</span><span class="p">)</span>  <span class="c1"># Make a specutils region</span>

<span class="c1"># Another continuum fit for wavelengths under 13 microns excluding the silicate absorption feature</span>
<span class="n">to_exclude_2</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">,</span> <span class="p">(</span><span class="mf">13.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">]</span>
<span class="n">exclude_region_2</span> <span class="o">=</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="n">to_exclude_2</span><span class="p">)</span>

<span class="n">continuum_model_1</span> <span class="o">=</span> <span class="n">fit_generic_continuum</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">exclude_regions</span><span class="o">=</span><span class="n">exclude_region_1</span><span class="p">)</span>  <span class="c1"># Generate the first contimiumn</span>
<span class="n">continuum_model_2</span> <span class="o">=</span> <span class="n">fit_generic_continuum</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">exclude_regions</span><span class="o">=</span><span class="n">exclude_region_2</span><span class="p">)</span>  <span class="c1"># Generate the second contimiumn</span>
<span class="n">y_continuum_1</span> <span class="o">=</span> <span class="n">continuum_model_1</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">)</span>  <span class="c1"># Put the first continiumn into 1d spectra object</span>
<span class="n">y_continuum_2</span> <span class="o">=</span> <span class="n">continuum_model_2</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">)</span>  <span class="c1"># Put the second continiumn into 1d spectra object</span>

<span class="c1"># Generate a continuum subtracted and continuum normalised spectra. Both needed for later analysis. </span>
<span class="n">spec_norm_2</span> <span class="o">=</span> <span class="n">spec</span> <span class="o">/</span> <span class="n">y_continuum_2</span>
<span class="n">count_axis</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mf">13.0</span><span class="p">:</span>
        <span class="n">count_axis</span> <span class="o">=</span> <span class="n">count_axis</span><span class="o">+</span><span class="mi">1</span>

<span class="c1"># Assign to variable to make it more readable for line below</span>
<span class="n">spec_contsub_1</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="n">count_axis</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">)]</span> <span class="o">-</span> <span class="n">y_continuum_1</span><span class="p">[</span><span class="n">count_axis</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">)]</span>
<span class="n">spec_contsub_2</span> <span class="o">=</span> <span class="n">spec</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">count_axis</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_continuum_2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">count_axis</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the continiumn and spectra</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Source&#39;</span><span class="p">)</span>  <span class="c1"># Source spectrum </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">y_continuum_1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Continuum Fit to lambda &gt; 13 microns&#39;</span><span class="p">)</span>  <span class="c1"># Continuum (lambda &gt; 13 microns)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">y_continuum_2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Continuum Fit to lambda &lt; 13 microns&#39;</span><span class="p">)</span>  <span class="c1"># Continuum (lambda &lt; 13 microns)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the contimum subtracted spectrum</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec_contsub_1</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec_contsub_1</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec_contsub_2</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec_contsub_2</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="look-for-emission-and-absorption-lines">
<h2>Look For Emission and Absorption Lines<a class="headerlink" href="#look-for-emission-and-absorption-lines" title="Permalink to this headline">¶</a></h2>
<p>Common YSO lines include PAH emission lines, ice absorption lines, and silicate absorption lines.</p>
<p>It would be better to have a SNR threshold instead of a flux threshold for the find_lines_derivative function.</p>
<p>The user has to remove the comment depending on which YSO they are checking: YSO1, YSO2, or YSO3. If it was a SNR threshold instead, then it can be a bit more automated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find emmision and absorption lines in the continuum-subtracted spectra.</span>
<span class="c1"># This will print out two emission line lists and two absorption line lists.</span>

<span class="k">if</span> <span class="n">sig2noise</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">find_lines_derivative</span><span class="p">(</span><span class="n">spec_contsub_1</span><span class="p">,</span> <span class="n">flux_threshold</span><span class="o">=</span><span class="mf">0.020</span><span class="p">)</span>  <span class="c1"># YSO 1</span>
    <span class="c1"># lines = find_lines_derivative(spec_contsub_1, flux_threshold=0.03)  # YSO 2</span>
    <span class="c1"># lines = find_lines_derivative(spec_contsub_1, flux_threshold=0.02)  # YSO 3</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">emissionlines_1</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">lines</span><span class="p">[</span><span class="s1">&#39;line_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;emission&#39;</span><span class="p">]</span>  <span class="c1"># Grab a list of the emission lines</span>
        <span class="n">abslines_1</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">lines</span><span class="p">[</span><span class="s1">&#39;line_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;absorption&#39;</span><span class="p">]</span>  <span class="c1"># Grab a list of the absorption lines</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of emission lines found:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">emissionlines_1</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of absorption lines found:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">abslines_1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">emissionlines_1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">abslines_1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No emission lines found!&quot;</span><span class="p">)</span> 

    <span class="n">lines</span> <span class="o">=</span> <span class="n">find_lines_derivative</span><span class="p">(</span><span class="n">spec_contsub_2</span><span class="p">,</span> <span class="n">flux_threshold</span><span class="o">=</span><span class="mf">0.020</span><span class="p">)</span>  <span class="c1"># YSO 1</span>
    <span class="c1"># lines = find_lines_derivative(spec_contsub_2, flux_threshold=0.03)  # YSO 2</span>
    <span class="c1"># lines = find_lines_derivative(spec_contsub_2, flux_threshold=0.02)  # YSO 3</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">emissionlines_2</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">lines</span><span class="p">[</span><span class="s1">&#39;line_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;emission&#39;</span><span class="p">]</span>  <span class="c1"># Grab a list of the emission lines</span>
        <span class="n">abslines_2</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">lines</span><span class="p">[</span><span class="s1">&#39;line_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;absorption&#39;</span><span class="p">]</span>  <span class="c1"># Grab a list of the absorption lines</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of emission lines found:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">emissionlines_2</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of absorption lines found:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">abslines_2</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">emissionlines_2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">abslines_2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No emission lines found!&quot;</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract emission lines greater than 13 microns</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">emissionlines_1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">emissionlines_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">emissionlines_1</span><span class="p">[</span><span class="s1">&#39;gauss_line_center&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">emissionlines_1</span><span class="p">[</span><span class="s1">&#39;gauss_line_amp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">jansky</span>
    <span class="n">emissionlines_1</span><span class="p">[</span><span class="s1">&#39;gauss_line_stddev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">emissionlines_1</span><span class="p">[</span><span class="s1">&#39;gauss_line_FWHM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">emissionlines_1</span><span class="p">[</span><span class="s1">&#39;gauss_line_area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1e-20</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">W</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">emissionlines_1</span><span class="p">[</span><span class="s1">&#39;no_AltRestWav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Number of possible lines which could be the feature</span>
    <span class="n">emissionlines_1</span><span class="p">[</span><span class="s1">&#39;RestWav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># RestWavelength of closest lab measured line</span>
    <span class="n">emissionlines_1</span><span class="p">[</span><span class="s1">&#39;diff_ft_wav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Diff. in initial line wav estimate and the fitted gausian</span>
    <span class="n">emissionlines_1</span><span class="p">[</span><span class="s1">&#39;line_suspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Set == 1 if large diffrence in wavelength possition</span>
    <span class="n">emissionlines_1</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;                 &quot;</span>  <span class="c1"># For storing the line name</span>

    <span class="c1"># Loop through all the found emission lines in the spectra</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">emlines</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">emissionlines_1</span><span class="p">):</span>

        <span class="c1"># Look at the region surrounding the found lines from the original smoothed spectrum</span>
        <span class="n">sw_line</span> <span class="o">=</span> <span class="n">emissionlines_1</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">-</span><span class="mf">0.001</span>
        <span class="n">lw_line</span> <span class="o">=</span> <span class="n">emissionlines_1</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">+</span><span class="mf">0.001</span>     
        <span class="n">line_region</span> <span class="o">=</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="n">sw_line</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">um</span><span class="p">,</span> <span class="n">lw_line</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">um</span><span class="p">)</span>

        <span class="c1"># Variable for the line center</span>
        <span class="n">line_cnr</span> <span class="o">=</span> <span class="n">emissionlines_1</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
        
<span class="nb">print</span><span class="p">(</span><span class="n">emissionlines_1</span><span class="p">)</span>

<span class="c1"># Extract emission lines less than 13 microns</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">emissionlines_2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">emissionlines_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">emissionlines_2</span><span class="p">[</span><span class="s1">&#39;gauss_line_center&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">emissionlines_2</span><span class="p">[</span><span class="s1">&#39;gauss_line_amp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">jansky</span>
    <span class="n">emissionlines_2</span><span class="p">[</span><span class="s1">&#39;gauss_line_stddev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">emissionlines_2</span><span class="p">[</span><span class="s1">&#39;gauss_line_FWHM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">emissionlines_2</span><span class="p">[</span><span class="s1">&#39;gauss_line_area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1e-20</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">W</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">emissionlines_2</span><span class="p">[</span><span class="s1">&#39;no_AltRestWav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Number of possible lines which could be the feature</span>
    <span class="n">emissionlines_2</span><span class="p">[</span><span class="s1">&#39;RestWav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># RestWavelength of closest lab measured line</span>
    <span class="n">emissionlines_2</span><span class="p">[</span><span class="s1">&#39;diff_ft_wav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Diff. in initial line wav estimate and the fitted gausian</span>
    <span class="n">emissionlines_2</span><span class="p">[</span><span class="s1">&#39;line_suspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Set == 1 if large diffrence in wavelength possition</span>
    <span class="n">emissionlines_2</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;                 &quot;</span>  <span class="c1"># For storing the line name</span>
    
    <span class="c1"># Loop through all the found emission lines in the spectra</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">emlines2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">emissionlines_2</span><span class="p">):</span>

        <span class="c1"># Look at the region surrounding the found lines from the original smoothed spectrum</span>
        <span class="n">sw_line</span> <span class="o">=</span> <span class="n">emissionlines_2</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">-</span><span class="mf">0.01</span>
        <span class="n">lw_line</span> <span class="o">=</span> <span class="n">emissionlines_2</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">+</span><span class="mf">0.01</span>     
        <span class="n">line_region</span> <span class="o">=</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="n">sw_line</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">um</span><span class="p">,</span> <span class="n">lw_line</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">um</span><span class="p">)</span>

        <span class="c1"># Variable for the line center</span>
        <span class="n">line_cnr</span> <span class="o">=</span> <span class="n">emissionlines_2</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>     
         
<span class="nb">print</span><span class="p">(</span><span class="n">emissionlines_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract absorption lines greater than 13 microns</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">abslines_1</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">abslines_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">abslines_1</span><span class="p">[</span><span class="s1">&#39;gauss_line_center&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">abslines_1</span><span class="p">[</span><span class="s1">&#39;gauss_line_amp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">jansky</span>
    <span class="n">abslines_1</span><span class="p">[</span><span class="s1">&#39;gauss_line_stddev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">abslines_1</span><span class="p">[</span><span class="s1">&#39;gauss_line_FWHM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">abslines_1</span><span class="p">[</span><span class="s1">&#39;gauss_line_area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1e-20</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">W</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">abslines_1</span><span class="p">[</span><span class="s1">&#39;no_AltRestWav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Number of possible lines which could be the feature</span>
    <span class="n">abslines_1</span><span class="p">[</span><span class="s1">&#39;RestWav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># RestWavelength of closest lab measured line</span>
    <span class="n">abslines_1</span><span class="p">[</span><span class="s1">&#39;diff_ft_wav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Diff. in initial line wav estimate and the fitted gausian</span>
    <span class="n">abslines_1</span><span class="p">[</span><span class="s1">&#39;line_suspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Set == 1 if large diffrence in wavelength possition</span>
    <span class="n">abslines_1</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;                 &quot;</span>  <span class="c1"># For storing the line name</span>

    <span class="c1"># Loop through all the found absorption lines in the spectra</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">absorplines</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">abslines_1</span><span class="p">):</span>

        <span class="c1"># Look at the region surrounding the found lines from the original smoothed spectrum</span>
        <span class="n">sw_line</span> <span class="o">=</span> <span class="n">abslines_1</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">-</span><span class="mf">0.01</span>
        <span class="n">lw_line</span> <span class="o">=</span> <span class="n">abslines_1</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">+</span><span class="mf">0.01</span>     
        <span class="n">line_region</span> <span class="o">=</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="n">sw_line</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">um</span><span class="p">,</span> <span class="n">lw_line</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">um</span><span class="p">)</span>

        <span class="c1"># Variable for the line center</span>
        <span class="n">line_cnr_abs</span> <span class="o">=</span> <span class="n">abslines_1</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
        
<span class="nb">print</span><span class="p">(</span><span class="n">abslines_1</span><span class="p">)</span>

<span class="c1"># Extract absorption lines less than 13 microns</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">abslines_2</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">abslines_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">abslines_2</span><span class="p">[</span><span class="s1">&#39;gauss_line_center&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">abslines_2</span><span class="p">[</span><span class="s1">&#39;gauss_line_amp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">jansky</span>
    <span class="n">abslines_2</span><span class="p">[</span><span class="s1">&#39;gauss_line_stddev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">abslines_2</span><span class="p">[</span><span class="s1">&#39;gauss_line_FWHM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">abslines_2</span><span class="p">[</span><span class="s1">&#39;gauss_line_area&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1e-20</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">W</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">abslines_2</span><span class="p">[</span><span class="s1">&#39;no_AltRestWav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Number of possible lines which could be the feature</span>
    <span class="n">abslines_2</span><span class="p">[</span><span class="s1">&#39;RestWav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># RestWavelength of closest lab measured line</span>
    <span class="n">abslines_2</span><span class="p">[</span><span class="s1">&#39;diff_ft_wav&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>  <span class="c1"># Diff. in initial line wav estimate and the fitted gausian</span>
    <span class="n">abslines_2</span><span class="p">[</span><span class="s1">&#39;line_suspect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Set == 1 if large diffrence in wavelength possition</span>
    <span class="n">abslines_2</span><span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;                 &quot;</span>  <span class="c1"># For storing the line name</span>
    
    <span class="c1"># Loop through all the found absorption lines in the spectra</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">absorplines2</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">abslines_2</span><span class="p">):</span>

        <span class="c1"># Look at the region surrounding the found lines from the original smoothed spectrum</span>
        <span class="n">sw_line</span> <span class="o">=</span> <span class="n">abslines_2</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.01</span>
        <span class="n">lw_line</span> <span class="o">=</span> <span class="n">abslines_2</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.01</span>     
        <span class="n">line_region</span> <span class="o">=</span> <span class="n">SpectralRegion</span><span class="p">(</span><span class="n">sw_line</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">um</span><span class="p">,</span> <span class="n">lw_line</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">um</span><span class="p">)</span>

        <span class="c1"># Variable for the line center</span>
        <span class="n">line_cnr_abs</span> <span class="o">=</span> <span class="n">abslines_2</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">abslines_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="identify-emission-and-absorption-lines">
<h2>Identify emission and absorption lines<a class="headerlink" href="#identify-emission-and-absorption-lines" title="Permalink to this headline">¶</a></h2>
<p>PAH emission feature: 6.2 micron, 7.7 micron, 8.6 micron, 11.3 micron, 12.0 micron, 12.7 micron, 14.2 micron, 16.2 micron</p>
<p>Silicate absoprtion feature: 10.0 micron, 18.0 micron, 23.0 micron</p>
<p>CO2 ice absorption feature: 15.2 micron</p>
<p>Other ice features: CO (4.67 micron), H2O + HCOOH (6 micron),  CH3OH (6.89 micron), CH4 (7.7 micron)</p>
<p>If none of these 8 emission lines and 8 absorption lines exist, then this is not a YSO</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First Look for pah emission features</span>

<span class="n">pah_emission</span> <span class="o">=</span> <span class="p">[</span><span class="mf">6.2</span><span class="p">,</span> <span class="mf">7.7</span><span class="p">,</span> <span class="mf">8.6</span><span class="p">,</span> <span class="mf">11.3</span><span class="p">,</span> <span class="mf">12.0</span><span class="p">,</span> <span class="mf">12.7</span><span class="p">,</span> <span class="mf">14.2</span><span class="p">,</span> <span class="mf">16.2</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>  <span class="c1"># list or known YSO pah emission lines</span>
<span class="n">len_pah_list</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pah_emission</span><span class="p">)</span>

<span class="n">pah_emission_detected</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># empty array to store detected lines</span>
<span class="n">line_cnr_list_1</span> <span class="o">=</span> <span class="n">emissionlines_1</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">]</span>  <span class="c1"># list of emission lines extracted from first spectrum</span>
<span class="n">len_line_list</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_cnr_list_1</span><span class="p">)</span>
<span class="n">line_cnr_list_2</span> <span class="o">=</span> <span class="n">emissionlines_2</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">]</span>  <span class="c1"># list of emission lines extracted from second spectrum</span>
<span class="n">len_line_list2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_cnr_list_2</span><span class="p">)</span>

<span class="n">count_pah1</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># counting how many pah emission lines exist in first spectrum</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_pah_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.15</span> <span class="o">&lt;</span> <span class="n">pah_emission</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.15</span><span class="p">:</span>
            <span class="n">count_pah1</span> <span class="o">=</span> <span class="n">count_pah1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">count_pah2</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># counting how many pah emission lines exist in second spectrum</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_pah_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.15</span> <span class="o">&lt;</span> <span class="n">pah_emission</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.15</span><span class="p">:</span>
            <span class="n">count_pah2</span> <span class="o">=</span> <span class="n">count_pah2</span><span class="o">+</span><span class="mi">1</span>

<span class="n">pah_emission_detected</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">count_pah1</span> <span class="o">+</span> <span class="n">count_pah2</span><span class="p">)</span>  <span class="c1"># empty array to store detected lines</span>
<span class="n">count_pah</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># restart count</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_pah_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.15</span> <span class="o">&lt;</span> <span class="n">pah_emission</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.15</span><span class="p">:</span>
            <span class="n">pah_emission_detected</span><span class="p">[</span><span class="n">count_pah</span><span class="p">]</span> <span class="o">=</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">count_pah</span> <span class="o">=</span> <span class="n">count_pah</span> <span class="o">+</span> <span class="mi">1_1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.15</span> <span class="o">&lt;</span> <span class="n">pah_emission</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.15</span><span class="p">:</span>
            <span class="n">pah_emission_detected</span><span class="p">[</span><span class="n">count_pah</span><span class="p">]</span> <span class="o">=</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">count_pah</span> <span class="o">=</span> <span class="n">count_pah</span> <span class="o">+</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="n">count_pah</span><span class="p">,</span> <span class="s2">&quot;pah emission lines detected in spectrum&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">count_pah</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">pah_emission_detected</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">pah_emission_detected</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look for Silicate absorption features</span>

<span class="n">sil_absorption</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">18.0</span><span class="p">,</span> <span class="mf">23.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>  <span class="c1"># list or known YSO silicate absorption lines</span>
<span class="n">len_sil_list</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sil_absorption</span><span class="p">)</span>

<span class="n">sil_absorption_detected</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># empty array to store detected lines</span>
<span class="n">line_cnr_list_1</span> <span class="o">=</span> <span class="n">abslines_1</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">]</span>  <span class="c1"># list of absorption lines extracted from first spectrum</span>
<span class="n">len_line_list</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_cnr_list_1</span><span class="p">)</span>
<span class="n">line_cnr_list_2</span> <span class="o">=</span> <span class="n">abslines_2</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">]</span>  <span class="c1"># list of absorption lines extracted from second spectrum</span>
<span class="n">len_line_list2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_cnr_list_2</span><span class="p">)</span>

<span class="n">count_sil1</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># counting how many silicate absorption lines exist in first spectrum</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_sil_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.3</span> <span class="o">&lt;</span> <span class="n">sil_absorption</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">:</span>  <span class="c1"># absorption features are wider than emission features therefore +/-0.2</span>
            <span class="n">count_sil1</span> <span class="o">=</span> <span class="n">count_sil1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">count_sil2</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># counting how many silicate absorption lines exist in second spectrum</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_sil_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.3</span> <span class="o">&lt;</span> <span class="n">sil_absorption</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">:</span>  <span class="c1"># absorption features are wider than emission features therefore +/-0.2</span>
            <span class="n">count_sil2</span> <span class="o">=</span> <span class="n">count_sil2</span> <span class="o">+</span> <span class="mi">1</span>
            
<span class="n">sil_absorption_detected</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">count_sil1</span> <span class="o">+</span> <span class="n">count_sil2</span><span class="p">)</span>  <span class="c1"># empty array to store detected lines</span>
<span class="n">count_sil</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># restart count</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_sil_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.3</span> <span class="o">&lt;</span> <span class="n">sil_absorption</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">:</span>
            <span class="n">sil_absorption_detected</span><span class="p">[</span><span class="n">count_sil</span><span class="p">]</span> <span class="o">=</span> <span class="n">sil_absorption</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">count_sil</span> <span class="o">=</span> <span class="n">count_sil</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.3</span> <span class="o">&lt;</span> <span class="n">sil_absorption</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.3</span><span class="p">:</span>
            <span class="n">sil_absorption_detected</span><span class="p">[</span><span class="n">count_sil</span><span class="p">]</span> <span class="o">=</span> <span class="n">sil_absorption</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">count_sil</span> <span class="o">=</span> <span class="n">count_sil</span> <span class="o">+</span> <span class="mi">1</span>
        
<span class="k">if</span> <span class="n">count_sil</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">sil_absorption_detected</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
          
<span class="c1"># Remove multiple detection of same line</span>
<span class="n">test_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">count_sil</span>

<span class="k">if</span> <span class="n">count_sil</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count_sil</span><span class="p">):</span>
        <span class="n">test_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sil_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
    <span class="n">drop_dups_sil</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_list</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drop_dups_sil</span><span class="p">),</span> <span class="s2">&quot;silicate absorption lines detected in spectrum&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;0 silicate absorption lines detected in spectrum&quot;</span><span class="p">)</span>
    <span class="n">drop_dups_sil</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look for ice absorption features</span>

<span class="n">ice_absorption</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.67</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">6.9</span><span class="p">,</span> <span class="mf">7.7</span><span class="p">,</span> <span class="mf">15.2</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>  <span class="c1"># list or known YSO ice absorption lines</span>
<span class="n">len_ice_list</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ice_absorption</span><span class="p">)</span>

<span class="n">ice_absorption_detected</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># empty array to store detected lines</span>
<span class="n">line_cnr_list_1</span> <span class="o">=</span> <span class="n">abslines_1</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">]</span>  <span class="c1"># list of absorption lines extracted from first spectrum</span>
<span class="n">len_line_list</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_cnr_list_1</span><span class="p">)</span>
<span class="n">line_cnr_list_2</span> <span class="o">=</span> <span class="n">abslines_2</span><span class="p">[</span><span class="s2">&quot;line_center&quot;</span><span class="p">]</span>  <span class="c1"># list of absorption lines extracted from second spectrum</span>
<span class="n">len_line_list2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">line_cnr_list_2</span><span class="p">)</span>

<span class="n">count_ice1</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># counting how many ice absorption lines exist in first spectrum</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_ice_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.2</span> <span class="o">&lt;</span> <span class="n">ice_absorption</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">:</span>   
            <span class="n">count_ice1</span> <span class="o">=</span> <span class="n">count_ice1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">count_ice2</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># counting how many ice absorption lines exist in second spectrum</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_ice_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.2</span> <span class="o">&lt;</span> <span class="n">ice_absorption</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">:</span> 
            <span class="n">count_ice2</span> <span class="o">=</span> <span class="n">count_ice2</span> <span class="o">+</span> <span class="mi">1</span>
            
<span class="n">ice_absorption_detected</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">count_ice1</span> <span class="o">+</span> <span class="n">count_ice2</span><span class="p">)</span>  <span class="c1"># empty array to store detected lines</span>
<span class="n">count_ice</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># restart count</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_ice_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.2</span> <span class="o">&lt;</span> <span class="n">ice_absorption</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_1</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">:</span>
            <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">count_ice</span><span class="p">]</span> <span class="o">=</span> <span class="n">ice_absorption</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">count_ice</span> <span class="o">=</span> <span class="n">count_ice</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len_line_list2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="mf">0.2</span> <span class="o">&lt;</span> <span class="n">ice_absorption</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">line_cnr_list_2</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">+</span> <span class="mf">0.2</span><span class="p">:</span>
            <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">count_ice</span><span class="p">]</span> <span class="o">=</span> <span class="n">ice_absorption</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">count_ice</span> <span class="o">=</span> <span class="n">count_ice</span> <span class="o">+</span> <span class="mi">1</span>

<span class="k">if</span> <span class="n">count_ice</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ice_absorption_detected</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
          
<span class="c1"># Remove multiple detection of same line</span>
<span class="n">test_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span> <span class="o">*</span> <span class="n">count_ice</span>

<span class="k">if</span> <span class="n">count_ice</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count_ice</span><span class="p">):</span>
        <span class="n">test_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">drop_dups_ice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">test_list</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drop_dups_ice</span><span class="p">),</span> <span class="s2">&quot;ice absorption lines detected in spectrum&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;0 ice absorption lines detected in spectrum&quot;</span><span class="p">)</span>
    <span class="n">drop_dups_ice</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="classify-the-yso-according-to-what-lines-are-detected">
<h2>Classify the YSO according to what lines are detected<a class="headerlink" href="#classify-the-yso-according-to-what-lines-are-detected" title="Permalink to this headline">¶</a></h2>
<p>If more than one classification pops up, then the user needs to take a closer look and the YSO can be inbetween. For example if you get “This is a Class 2 YSO” and “This is a class 3 YSO”, then the protostar can be inbetween these two phases in its evolution and be a Class 2/3 YSO.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If no PAH, silicate, and ice lines found then print this is not a YSO</span>
<span class="k">if</span> <span class="n">pah_emission_detected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">sil_absorption_detected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is not a YSO.&quot;</span><span class="p">)</span>

<span class="c1"># Else find out if YSO 1 (youngest, most embedded YSO with CO2 absorption feature at 15.2 microns)</span>
<span class="k">if</span> <span class="n">pah_emission_detected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">sil_absorption_detected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drop_dups_ice</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drop_dups_sil</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count_ice</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mf">15.4</span> <span class="ow">and</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mf">15.0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a Class 1 YSO.&quot;</span><span class="p">)</span>
                        
<span class="c1"># Else find out if YSO 2 (more evolved YSO with other ice absoprtion and silicate absorption features)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drop_dups_sil</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a Class 2 YSO.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">drop_dups_ice</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count_ice</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mf">4.87</span> <span class="ow">and</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mf">4.47</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a Class 2 YSO.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mf">5.8</span> <span class="ow">and</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mf">6.2</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a Class 2 YSO.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mf">6.69</span> <span class="ow">and</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mf">7.09</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a Class 2 YSO.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;</span> <span class="mf">7.5</span> <span class="ow">and</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mf">7.7</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a Class 2 YSO.&quot;</span><span class="p">)</span>
                    
<span class="c1"># Else if PAH emission features then YSO 3</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">count_pah</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drop_dups_ice</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a Class 3 YSO.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">count_pah</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">drop_dups_sil</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is a Class 3 YSO.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-the-spectra-and-label-the-emission-and-absorption-features">
<h2>Plot the spectra and label the emission and absorption features<a class="headerlink" href="#plot-the-spectra-and-label-the-emission-and-absorption-features" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec_contsub_1</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec_contsub_1</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">spec_contsub_2</span><span class="o">.</span><span class="n">spectral_axis</span><span class="p">,</span> <span class="n">spec_contsub_2</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wavelength ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">spectral_axis</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Flux ({:latex})&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">spec</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

<span class="n">max_emission</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">spec_contsub_2</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pah_emission_detected</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">pah_emission_detected</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">pah_emission_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">pah_emission_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">max_emission</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">max_emission</span> <span class="o">*</span> <span class="mi">4</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;PAH emission&#39;</span><span class="p">)</span>    

<span class="nb">print</span><span class="p">(</span><span class="n">pah_emission_detected</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sil_absorption_detected</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sil_absorption_detected</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">sil_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">sil_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">max_emission</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">max_emission</span> <span class="o">*</span> <span class="mi">4</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;silicate absorption&#39;</span><span class="p">)</span>
    
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ice_absorption_detected</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ice_absorption_detected</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">ice_absorption_detected</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">max_emission</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">max_emission</span> <span class="o">*</span> <span class="mi">4</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ice absorption&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;medium&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/jdat_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/MIRI_IFU_YSOs_in_the_LMC"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../MRS_Mstar_analysis/JWST_Mstar_dataAnalysis_analysis.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">MIRI MRS Spectroscopy of a Late M Star 2 - Data Analysis and Visualization</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../MIRI_LRS_spectral_extraction/miri_lrs_spectral_extraction.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">MIRI LRS Optimal Spectral Extraction</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By STScI<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>